"use strict";var Certificate=require("../models/Certificate"),PDFDocument=require("pdfkit"),fs=require("fs"),path=require("path");exports.generateCertificate=function(t,r){var n,a,i,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body.user_id,e.prev=1,e.next=4,regeneratorRuntime.awrap(Certificate.findOne({where:{user_id:n}}));case 4:if(e.sent)return e.abrupt("return",r.status(400).json({message:"Certificate already exists for this user."}));e.next=7;break;case 7:return a=new PDFDocument,i=path.join(__dirname,"../certificates","".concat(n,".pdf")),a.pipe(fs.createWriteStream(i)),a.fontSize(25).text("Certificate of Achievement",{align:"center"}),a.moveDown(),a.fontSize(16).text("This certifies that",{align:"center"}),a.moveDown(),a.fontSize(20).text("User  ID: ".concat(n),{align:"center"}),a.moveDown(),a.fontSize(16).text("has successfully completed the course.",{align:"center"}),a.moveDown(),a.text("Issued on: ".concat((new Date).toLocaleDateString()),{align:"center"}),a.end(),e.next=22,regeneratorRuntime.awrap(Certificate.create({user_id:n,issued_date:new Date,certificate_url:"https://example.com/certificates/".concat(n,".pdf")}));case 22:s=e.sent,r.status(201).json({message:"Certificate generated successfully",certificate:s}),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(1),console.error("Error during certificate generation:",e.t0.message),r.status(500).json({error:e.t0.message});case 30:case"end":return e.stop()}},null,null,[[1,26]])};
//# sourceMappingURL=certificateController.min.js.map
